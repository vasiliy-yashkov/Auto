/******************************************************************************/
/***         Generated by IBExpert 2017.12.13.1 15.05.2018 10:08:41         ***/
/******************************************************************************/

SET SQL DIALECT 3;

SET NAMES NONE;

SET CLIENTLIB 'E:\core\Firebird-2.5.7.27050-0_Win32\bin\fbclient.dll';

CREATE DATABASE '127.0.0.1/3050:E:\tmp\auto\auto\bin\Debug\db\AUTO.FDB'
USER 'SYSDBA' PASSWORD 'masterkey'
PAGE_SIZE 16384
DEFAULT CHARACTER SET WIN1251 COLLATION WIN1251;



/******************************************************************************/
/***                           Stored procedures                            ***/
/******************************************************************************/



SET TERM ^ ;

CREATE PROCEDURE ENGINE_DETAIL (
    ENGINE_IDX BIGINT)
RETURNS (
    INFO VARCHAR(32654) CHARACTER SET NONE)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE MARK_DETAIL (
    MARK_IDX BIGINT)
RETURNS (
    INFO VARCHAR(32654) CHARACTER SET WIN1251)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE MOD_DETAIL (
    MOD_IDX BIGINT)
RETURNS (
    INFO VARCHAR(32654))
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE MODEL_DETAIL (
    MODEL_IDX BIGINT)
RETURNS (
    INFO VARCHAR(32654))
AS
BEGIN
  SUSPEND;
END^






SET TERM ; ^



/******************************************************************************/
/***                                 Tables                                 ***/
/******************************************************************************/



CREATE TABLE "AUTO" (
    AUTO_ID          BIGINT NOT NULL,
    AUTO_COLOR       VARCHAR(250) NOT NULL,
    STATUS_ID        BIGINT NOT NULL,
    MODIFICATION_ID  BIGINT,
    AUTO_VIN         VARCHAR(100) NOT NULL,
    MODEL_ID         BIGINT NOT NULL,
    ENGINE_ID        BIGINT NOT NULL
);

CREATE TABLE CLIENT (
    CLIENT_ID  BIGINT NOT NULL,
    PERSON_ID  BIGINT NOT NULL,
    AUTO_ID    BIGINT NOT NULL
);

CREATE TABLE DELIVERY (
    DELIVERY_ID     BIGINT NOT NULL,
    PROVIDER_ID     BIGINT NOT NULL,
    AUTO_ID         BIGINT NOT NULL,
    DELIVERY_DATE   DATE NOT NULL,
    DELIVERY_PRICE  DECIMAL(15,2) NOT NULL
);

CREATE TABLE PERSON (
    PERSON_ID           BIGINT NOT NULL,
    PERSON_NAME         VARCHAR(250) NOT NULL,
    PERSON_LAST_NAME    VARCHAR(250) NOT NULL,
    PERSON_MIDDLE_NAME  VARCHAR(250),
    PERSON_BIRTHDAY     DATE NOT NULL
);

CREATE TABLE POST (
    POST_ID    BIGINT NOT NULL,
    POST_NAME  VARCHAR(250) NOT NULL
);

CREATE TABLE EMPLOYEE (
    EMPLOYEE_ID          BIGINT NOT NULL,
    PERSON_ID            BIGINT NOT NULL,
    EMPLOYEE_BEGIN_DATE  DATE NOT NULL,
    EMPLOYEE_SALARY      DECIMAL(15,2),
    POST_ID              BIGINT NOT NULL
);

CREATE TABLE ENGINE (
    ENGINE_ID           BIGINT NOT NULL,
    ENGINE_VOLUME       NUMERIC(15,2) NOT NULL,
    ENGINE_POWER        INTEGER NOT NULL,
    ENGINE_TYPE         VARCHAR(250) NOT NULL,
    ENGINE_CONSUMPTION  NUMERIC(15,2) NOT NULL
);

CREATE TABLE MARK (
    MARK_ID    BIGINT NOT NULL,
    MARK_NAME  VARCHAR(250) NOT NULL
);

CREATE TABLE MODEL (
    MODEL_ID    BIGINT NOT NULL,
    MARK_ID     BIGINT NOT NULL,
    MODEL_NAME  VARCHAR(250) NOT NULL
);

CREATE TABLE MODIFICATION (
    MODIFICATION_ID    BIGINT NOT NULL,
    MODIFICATION_NAME  VARCHAR(250) DEFAULT ' ',
    MODIFICATION_BODY  VARCHAR(250) NOT NULL,
    TRANSMISSION       VARCHAR(100) NOT NULL
);

CREATE TABLE PAY (
    PAY_ID    BIGINT NOT NULL,
    PAY_NAME  VARCHAR(250) NOT NULL
);

CREATE TABLE PERSON_INFO (
    PERSON_INFO_ID  BIGINT NOT NULL,
    PERSON_PHONE    VARCHAR(20) DEFAULT '+7-(123)-456-7890' NOT NULL,
    PERSON_ADDRESS  VARCHAR(500) NOT NULL,
    PERSON_ID       BIGINT
);

CREATE TABLE PROVIDER (
    PROVIDER_ID    BIGINT NOT NULL,
    PROVIDER_NAME  VARCHAR(250) NOT NULL,
    PROVIDER_INFO  VARCHAR(1000)
);

CREATE TABLE SALE (
    SALE_ID      BIGINT NOT NULL,
    SALE_DATE    DATE NOT NULL,
    PERSON_ID    BIGINT NOT NULL,
    EMPLOYEE_ID  BIGINT NOT NULL,
    AUTO_ID      BIGINT NOT NULL,
    SALE_PRICE   DECIMAL(15,2) NOT NULL,
    PAY_ID       BIGINT NOT NULL
);

CREATE TABLE STATUS (
    STATUS_ID    BIGINT NOT NULL,
    STATUS_NAME  VARCHAR(250) NOT NULL
);



ALTER TABLE "AUTO" ADD AUTO_FULL COMPUTED BY ((select * from MODEL_DETAIL(MODEL_ID)) || ' Цвет: ' || AUTO_COLOR ||
' Двигатель: ' || (select * from ENGINE_DETAIL(ENGINE_ID)) ||
' Мод.: ' || (select * from MOD_DETAIL(MODIFICATION_ID)));
ALTER TABLE ENGINE ADD ENGINE_FULL COMPUTED BY ((' Объем: ' || ENGINE_VOLUME || 'Мощность(л.с.): ' || ENGINE_POWER || ' Тип: ' ||
ENGINE_TYPE || ' Расход(100км): ' || ENGINE_CONSUMPTION));
ALTER TABLE MODEL ADD MODEL_FULL COMPUTED BY ((select * from MARK_DETAIL(MARK_ID)) || ' ' || MODEL_NAME);
ALTER TABLE MODIFICATION ADD "FULL" COMPUTED BY ((MODIFICATION_NAME || ' Кузов: ' || MODIFICATION_BODY || ' КПП: ' ||
TRANSMISSION));
ALTER TABLE PERSON ADD PERSON_FULL COMPUTED BY (( PERSON_LAST_NAME || ' ' || PERSON_NAME || ' ' || PERSON_MIDDLE_NAME ));
ALTER TABLE EMPLOYEE ADD EMPLOYEE_FULL COMPUTED BY ((select first 1 p.PERSON_FULL from PERSON p where p.PERSON_ID = PERSON_ID) ||
', ' || (select first 1 pt.POST_NAME from POST pt where pt.POST_ID = POST_ID));

INSERT INTO ENGINE (ENGINE_ID, ENGINE_VOLUME, ENGINE_POWER, ENGINE_TYPE, ENGINE_CONSUMPTION) VALUES (1, 1.6, 100, 'Бензиновый', 10);
INSERT INTO ENGINE (ENGINE_ID, ENGINE_VOLUME, ENGINE_POWER, ENGINE_TYPE, ENGINE_CONSUMPTION) VALUES (2, 1.8, 125, 'Бензиновый', 12);
INSERT INTO ENGINE (ENGINE_ID, ENGINE_VOLUME, ENGINE_POWER, ENGINE_TYPE, ENGINE_CONSUMPTION) VALUES (-1, 2, 145, 'Бензиновый', 14);

COMMIT WORK;

INSERT INTO MARK (MARK_ID, MARK_NAME) VALUES (1, 'KIA');
INSERT INTO MARK (MARK_ID, MARK_NAME) VALUES (2, 'FORD');
INSERT INTO MARK (MARK_ID, MARK_NAME) VALUES (-2, 'NISSAN');

COMMIT WORK;

INSERT INTO MODEL (MODEL_ID, MARK_ID, MODEL_NAME) VALUES (2, 1, 'RIO');
INSERT INTO MODEL (MODEL_ID, MARK_ID, MODEL_NAME) VALUES (3, 1, 'RIO R');
INSERT INTO MODEL (MODEL_ID, MARK_ID, MODEL_NAME) VALUES (4, 2, 'MONDEO');
INSERT INTO MODEL (MODEL_ID, MARK_ID, MODEL_NAME) VALUES (5, 2, 'FOCUS');
INSERT INTO MODEL (MODEL_ID, MARK_ID, MODEL_NAME) VALUES (-1, -2, 'ALMERA');

COMMIT WORK;

INSERT INTO MODIFICATION (MODIFICATION_ID, MODIFICATION_NAME, MODIFICATION_BODY, TRANSMISSION) VALUES (0, 'Внедорожник', 'Хэтчбэк', 'Механика');
INSERT INTO MODIFICATION (MODIFICATION_ID, MODIFICATION_NAME, MODIFICATION_BODY, TRANSMISSION) VALUES (1, 'Простая', 'Седан', 'Автомат');
INSERT INTO MODIFICATION (MODIFICATION_ID, MODIFICATION_NAME, MODIFICATION_BODY, TRANSMISSION) VALUES (3, 'Простая2', 'Седан', 'Автома');

COMMIT WORK;

INSERT INTO STATUS (STATUS_ID, STATUS_NAME) VALUES (0, 'В наличии');
INSERT INTO STATUS (STATUS_ID, STATUS_NAME) VALUES (1, 'Готов к заказу');
INSERT INTO STATUS (STATUS_ID, STATUS_NAME) VALUES (3, 'Нет в наличии');

COMMIT WORK;

INSERT INTO "AUTO" (AUTO_ID, AUTO_COLOR, STATUS_ID, MODIFICATION_ID, AUTO_VIN, MODEL_ID, ENGINE_ID) VALUES (1, 'Белый', 3, 0, 'JHBASDBHJAD234234', 2, 1);
INSERT INTO "AUTO" (AUTO_ID, AUTO_COLOR, STATUS_ID, MODIFICATION_ID, AUTO_VIN, MODEL_ID, ENGINE_ID) VALUES (3, 'Черный', 3, 3, 'JHBDSHFGBSDHF4553', 4, -1);
INSERT INTO "AUTO" (AUTO_ID, AUTO_COLOR, STATUS_ID, MODIFICATION_ID, AUTO_VIN, MODEL_ID, ENGINE_ID) VALUES (-1, 'Белый', 3, 3, 'HJBHJSDFSFDSF345', 3, -1);

COMMIT WORK;

INSERT INTO PERSON (PERSON_ID, PERSON_NAME, PERSON_LAST_NAME, PERSON_MIDDLE_NAME, PERSON_BIRTHDAY) VALUES (0, 'Иван', 'Иванов', 'Иванович', '1960-12-12');
INSERT INTO PERSON (PERSON_ID, PERSON_NAME, PERSON_LAST_NAME, PERSON_MIDDLE_NAME, PERSON_BIRTHDAY) VALUES (2, 'Петр', 'Петров', 'Петрович', '1970-01-01');
INSERT INTO PERSON (PERSON_ID, PERSON_NAME, PERSON_LAST_NAME, PERSON_MIDDLE_NAME, PERSON_BIRTHDAY) VALUES (3, 'Семен', 'Сидоров', 'Семенович', '1988-07-04');
INSERT INTO PERSON (PERSON_ID, PERSON_NAME, PERSON_LAST_NAME, PERSON_MIDDLE_NAME, PERSON_BIRTHDAY) VALUES (4, 'Владимир', 'Владимиров', 'Владимирович', '1990-10-16');

COMMIT WORK;

INSERT INTO PROVIDER (PROVIDER_ID, PROVIDER_NAME, PROVIDER_INFO) VALUES (0, 'Ford', 'Официальный');
INSERT INTO PROVIDER (PROVIDER_ID, PROVIDER_NAME, PROVIDER_INFO) VALUES (1, 'Киа', 'Официальный');

COMMIT WORK;

INSERT INTO POST (POST_ID, POST_NAME) VALUES (0, 'Директор');
INSERT INTO POST (POST_ID, POST_NAME) VALUES (1, 'Продавец');
INSERT INTO POST (POST_ID, POST_NAME) VALUES (2, 'Продавец-консультант');
INSERT INTO POST (POST_ID, POST_NAME) VALUES (3, 'Менеджер');
INSERT INTO POST (POST_ID, POST_NAME) VALUES (4, 'Бухгалтер');

COMMIT WORK;

INSERT INTO EMPLOYEE (EMPLOYEE_ID, PERSON_ID, EMPLOYEE_BEGIN_DATE, EMPLOYEE_SALARY, POST_ID) VALUES (0, 2, '2012-12-12', 30000, 0);

COMMIT WORK;

INSERT INTO PAY (PAY_ID, PAY_NAME) VALUES (0, 'Наличный');
INSERT INTO PAY (PAY_ID, PAY_NAME) VALUES (1, 'Безналичный');
INSERT INTO PAY (PAY_ID, PAY_NAME) VALUES (2, 'Кредит');

COMMIT WORK;

INSERT INTO PERSON_INFO (PERSON_INFO_ID, PERSON_PHONE, PERSON_ADDRESS, PERSON_ID) VALUES (0, '+71234567890', 'Муром', 0);
INSERT INTO PERSON_INFO (PERSON_INFO_ID, PERSON_PHONE, PERSON_ADDRESS, PERSON_ID) VALUES (2, '+79081234567', 'Владимир', 2);

COMMIT WORK;

INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (2, '2017-06-04', 0, 0, 1, 1200000, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (3, '2017-06-04', 0, 0, 3, 1200000, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (4, '2017-06-04', 0, 0, -1, 12000000, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (5, '2017-06-04', 0, 0, 1, 1200000, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (6, '2017-06-08', 0, 0, -1, 1200000, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (7, '2017-06-12', 2, 0, 3, 1200000, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (8, '2017-06-08', 2, 0, 1, 120000, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (9, '2017-06-08', 0, 0, 3, 120000, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (10, '2017-06-08', 0, 0, -1, 120000, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (11, '2017-06-08', 0, 0, 1, 1230000, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (12, '2017-06-08', 0, 0, 3, 1200000, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (13, '2017-06-08', 0, 0, -1, 1200000, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (14, '2017-05-30', 0, 0, 1, 1230000, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (15, '2017-05-30', 0, 0, 3, 1230000, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (16, '2017-05-30', 0, 0, -1, 1230000, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (17, '2017-06-08', 0, 0, 1, 1200000, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (18, '2017-06-08', 0, 0, 3, 3244234234, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (19, '2017-06-08', 0, 0, -1, 234234234, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (20, '2017-06-08', 0, 0, -1, 1200000, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (21, '2017-06-08', 0, 0, 3, 1200000, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (22, '2017-06-08', 0, 0, 1, 1200000, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (23, '2017-06-08', 0, 0, -1, 1231231, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (24, '2017-06-08', 0, 0, 3, 1231231, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (25, '2017-06-08', 0, 0, 1, 1231231, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (26, '2017-06-08', 0, 0, 3, 1231231, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (27, '2017-06-08', 0, 0, -1, 1231231, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (28, '2017-06-08', 0, 0, 1, 1231231, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (29, '2017-06-08', 0, 0, 1, 1231231, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (30, '2017-06-08', 0, 0, 1, 1231231, 0);
INSERT INTO SALE (SALE_ID, SALE_DATE, PERSON_ID, EMPLOYEE_ID, AUTO_ID, SALE_PRICE, PAY_ID) VALUES (31, '2017-06-09', 0, 0, 1, 1231231, 0);

COMMIT WORK;

/******************************************************************************/
/***                              Primary keys                              ***/
/******************************************************************************/

ALTER TABLE "AUTO" ADD CONSTRAINT PK_AUTO PRIMARY KEY (AUTO_ID);
ALTER TABLE CLIENT ADD CONSTRAINT PK_CLIENT PRIMARY KEY (CLIENT_ID);
ALTER TABLE DELIVERY ADD CONSTRAINT PK_DELIVERY PRIMARY KEY (DELIVERY_ID);
ALTER TABLE EMPLOYEE ADD CONSTRAINT PK_EMPLOYEE PRIMARY KEY (EMPLOYEE_ID);
ALTER TABLE ENGINE ADD CONSTRAINT PK_ENGINE PRIMARY KEY (ENGINE_ID);
ALTER TABLE MARK ADD CONSTRAINT PK_MARK PRIMARY KEY (MARK_ID);
ALTER TABLE MODEL ADD CONSTRAINT PK_MODEL PRIMARY KEY (MODEL_ID);
ALTER TABLE MODIFICATION ADD CONSTRAINT PK_MODIFICATION PRIMARY KEY (MODIFICATION_ID);
ALTER TABLE PAY ADD CONSTRAINT PK_PAY PRIMARY KEY (PAY_ID);
ALTER TABLE PERSON ADD CONSTRAINT PK_PERSON PRIMARY KEY (PERSON_ID);
ALTER TABLE PERSON_INFO ADD CONSTRAINT PK_PERSON_INFO PRIMARY KEY (PERSON_INFO_ID);
ALTER TABLE POST ADD CONSTRAINT PK_POST PRIMARY KEY (POST_ID);
ALTER TABLE PROVIDER ADD CONSTRAINT PK_PROVIDER PRIMARY KEY (PROVIDER_ID);
ALTER TABLE SALE ADD CONSTRAINT PK_SALE PRIMARY KEY (SALE_ID);
ALTER TABLE STATUS ADD CONSTRAINT PK_STATUS PRIMARY KEY (STATUS_ID);


/******************************************************************************/
/***                              Foreign keys                              ***/
/******************************************************************************/

ALTER TABLE "AUTO" ADD CONSTRAINT FK_AUTO_1 FOREIGN KEY (STATUS_ID) REFERENCES STATUS (STATUS_ID);
ALTER TABLE "AUTO" ADD CONSTRAINT FK_AUTO_2 FOREIGN KEY (MODIFICATION_ID) REFERENCES MODIFICATION (MODIFICATION_ID);
ALTER TABLE "AUTO" ADD CONSTRAINT FK_AUTO_3 FOREIGN KEY (MODEL_ID) REFERENCES MODEL (MODEL_ID);
ALTER TABLE "AUTO" ADD CONSTRAINT FK_AUTO_4 FOREIGN KEY (ENGINE_ID) REFERENCES ENGINE (ENGINE_ID);
ALTER TABLE CLIENT ADD CONSTRAINT FK_CLIENT_1 FOREIGN KEY (PERSON_ID) REFERENCES PERSON (PERSON_ID);
ALTER TABLE CLIENT ADD CONSTRAINT FK_CLIENT_2 FOREIGN KEY (AUTO_ID) REFERENCES "AUTO" (AUTO_ID);
ALTER TABLE DELIVERY ADD CONSTRAINT FK_DELIVERY_1 FOREIGN KEY (PROVIDER_ID) REFERENCES PROVIDER (PROVIDER_ID);
ALTER TABLE DELIVERY ADD CONSTRAINT FK_DELIVERY_2 FOREIGN KEY (AUTO_ID) REFERENCES "AUTO" (AUTO_ID);
ALTER TABLE EMPLOYEE ADD CONSTRAINT FK_EMPLOYEE_1 FOREIGN KEY (PERSON_ID) REFERENCES PERSON (PERSON_ID);
ALTER TABLE EMPLOYEE ADD CONSTRAINT FK_EMPLOYEE_2 FOREIGN KEY (POST_ID) REFERENCES POST (POST_ID);
ALTER TABLE MODEL ADD CONSTRAINT FK_MODEL_1 FOREIGN KEY (MARK_ID) REFERENCES MARK (MARK_ID);
ALTER TABLE PERSON_INFO ADD CONSTRAINT FK_PERSON_INFO_1 FOREIGN KEY (PERSON_ID) REFERENCES PERSON (PERSON_ID);
ALTER TABLE SALE ADD CONSTRAINT FK_SALE_1 FOREIGN KEY (PERSON_ID) REFERENCES PERSON (PERSON_ID);
ALTER TABLE SALE ADD CONSTRAINT FK_SALE_2 FOREIGN KEY (EMPLOYEE_ID) REFERENCES EMPLOYEE (EMPLOYEE_ID);
ALTER TABLE SALE ADD CONSTRAINT FK_SALE_3 FOREIGN KEY (AUTO_ID) REFERENCES "AUTO" (AUTO_ID);
ALTER TABLE SALE ADD CONSTRAINT FK_SALE_4 FOREIGN KEY (PAY_ID) REFERENCES PAY (PAY_ID);


/******************************************************************************/
/***                           Stored procedures                            ***/
/******************************************************************************/



SET TERM ^ ;

ALTER PROCEDURE ENGINE_DETAIL (
    ENGINE_IDX BIGINT)
RETURNS (
    INFO VARCHAR(32654) CHARACTER SET WIN1251)
AS
begin
  info = '';
  for SELECT ENGINE_FULL
    FROM "ENGINE" e
    WHERE e.ENGINE_ID = :ENGINE_IDX
  INTO :INFO
  do
  suspend;
end^


ALTER PROCEDURE MARK_DETAIL (
    MARK_IDX BIGINT)
RETURNS (
    INFO VARCHAR(32654) CHARACTER SET WIN1251)
AS
begin
  info = '';
  for SELECT MARK_NAME
    FROM MARK m
    WHERE m.mark_id = :MARK_IDX
  INTO :INFO
  do
  suspend;
end^


ALTER PROCEDURE MOD_DETAIL (
    MOD_IDX BIGINT)
RETURNS (
    INFO VARCHAR(32654))
AS
begin
  info = '';
  for SELECT m."FULL"
    FROM MODIFICATION m
    WHERE m.modification_id = :MOD_IDX
  INTO :INFO
  do
  suspend;
end^


ALTER PROCEDURE MODEL_DETAIL (
    MODEL_IDX BIGINT)
RETURNS (
    INFO VARCHAR(32654))
AS
begin
  info = '';
  for SELECT MODEL_FULL
    FROM MODEL m
    WHERE m.model_id = :MODEL_IDX
  INTO :INFO
  do
  suspend;
end^



SET TERM ; ^